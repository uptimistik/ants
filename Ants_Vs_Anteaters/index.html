<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Colony Clash</title>
    <link rel="stylesheet" type="text/css" href="css/gse-style.css"/>
    <link rel="stylesheet" type="text/css" href="css/gse-style-loading.css"/>
    <link rel="stylesheet" type="text/css" href="css/styles.css"/>
</head>
<body>
    <div id="gse-player" class="gse-frame">
        <div class="gse-overlay">
            <div id="gse-text" class="gse-dialog">
                <div>
                    <button id="gse-text-cancel">Cancel</button>
                    <button id="gse-text-done">Done</button>
                    <p id="gse-text-prompt">Enter Ant Name:</p>
                </div>
                <div>
                    <textarea id="gse-text-input" placeholder="Enter your ant name here..."></textarea>
                </div>
            </div>
            <div id="gse-loading" style="visibility:visible;">
                <img src="images/gse-loading.png" alt="Loading..."/>
            </div>
        </div>
    </div>
    <div id="start-overlay" class="overlay">
        <h1>Ant Name: <span id="telegram-username"></span></h1>
        <button id="leaderboard-button">Leaderboard</button>
        <button id="start-button">Start</button>
    </div>
    <div id="leaderboard-overlay" class="overlay" style="display:none;">
        <h2>Ant Leaderboard</h2>
        <div id="total-ants"></div>
        <div id="your-last-score"></div>
        <div id="leaderboard-countdown"></div>
        <div id="leaderboard-container">
            <table id="leaderboard">
                <tr><th>Rank</th><th>Ant Name</th><th>Top Kills</th></tr>
            </table>
        </div>
        <button id="back-to-start-button">Back</button>
    </div>
    <div id="endgame-overlay" class="overlay" style="display:none;">
        <h2>Game Over</h2>
        <div id="final-score"></div>
        <div id="new-high-score" style="display:none;"></div>
        <button id="view-leaderboard-button">View Leaderboard</button>
        <button id="share-button">Share</button>
        <button id="replay-button">Play Again</button>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="js/app.js"></script>
    <script src="js/game.js"></script>
    <script type="text/javascript" src="js/gse/gse-export.js" async onload="onEngineLoad()"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const textInput = document.getElementById('gse-text-input');
            const doneButton = document.getElementById('gse-text-done');
            const cancelButton = document.getElementById('gse-text-cancel');

            // Pause the game when the input field is focused
            textInput.addEventListener('focus', function() {
                gse.pauseGame();
            });

            // Resume the game when the "Done" button is clicked
            doneButton.addEventListener('click', function() {
                gse.playGame();
            });

            // Optionally resume game if "Cancel" is clicked
            cancelButton.addEventListener('click', function() {
                gse.playGame();
            });

            // Prevent game actions during input typing
            textInput.addEventListener('input', function() {
                gse.pauseGame();
            });
        });
    </script>
</body>
</html>
