<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>AntsTheGame</title>
<link rel="stylesheet" type="text/css" href="css/gse-style.css" />
<link rel="stylesheet" type="text/css" href="css/gse-style-loading.css" />
<style type="text/css">
body {
    background-color: black;
    margin: 0;
    padding: 0;
}
</style>
</head>
<body>
<div id="gse-player" class="gse-frame">
    <div class="gse-overlay">
        <div id="gse-text" class="gse-dialog">
            <div>
                <button id="gse-text-cancel">Cancel</button>
                <button id="gse-text-done">Done</button>
                <p id="gse-text-prompt"></p>
            </div>
            <div>
                <textarea id="gse-text-input"></textarea>
            </div>
        </div>
        <div id="gse-browser" class="gse-dialog">           
            <iframe id="gse-browser-frame"></iframe>
                <button id="gse-browser-close" href="#">&#10006;</button>
        </div>
        <div id="gse-loading" style="visibility: visible;">
            <img src="images/gse-loading.png" />
        </div>
    </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<!-- Your app's Firebase configuration -->
<script src="js/app.js"></script>

<script type="text/javascript">
(function(global) {
    global.onEngineLoad = function() {
        gse.ready(function(engine) {
            var loadingElement = document.getElementById('gse-loading');
            var playerDelegate = {
                onLoadingBegin: function() {
                    engine.showOverlay();
                    loadingElement.style.visibility = 'visible';
                },

                onLoadingEnd: function() {
                    loadingElement.style.visibility = 'hidden';
                    engine.hideOverlay();
                },

                onWindowResize: function() {
                    engine.relayout();
                },

                onShowLeaderboard: function() {
                    if (isPlayerRegistered()) {
                        displayLeaderboard();
                    } else {
                        showCreateUsernameOverlay();
                    }
                }
            };
            engine.appendDelegate(playerDelegate);
            window.addEventListener('resize', playerDelegate.onWindowResize, false);

            engine.setRenderFrame('gse-player');
            engine.setOptions({
                'viewport-reference': 'window',
                'viewport-fit': 'letterbox'
            });
            engine.loadOptionsFromURL();

            engine.play();
        });
    };

    function isPlayerRegistered() {
        return localStorage.getItem('antUsername') !== null;
    }

    function displayLeaderboard() {
        // Implement leaderboard display logic here
        console.log("Displaying leaderboard");
    }

    function showCreateUsernameOverlay() {
        // Implement username creation overlay logic here
        console.log("Showing create username overlay");
    }

}(window));
</script>

<script type="text/javascript" src="js/gse/gse-export.js" async onload="onEngineLoad()"></script>
</body>
</html>